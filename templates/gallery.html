<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>TÃ¼rkamera Galerie</title>
    <!-- Korrektes CSS-Link -->
    <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
    <h1>TÃ¼rkamera Galerie</h1>
    <div id="datetime">{{ datum }} | <span id="uhrzeit">{{ uhrzeit }}</span></div>

    <!-- Button ohne Formular â€“ wird per JS gesteuert -->
    <button id="delete-btn" class="delete-button">ðŸ“¸ Galerie lÃ¶schen</button>

    <div class="gallery">
        {% for bild, dateiname, aufnahmezeit in bilder %}
            <div class="bild-container">
                <img src="/photo/{{ dateiname }}" alt="TÃ¼rkamera Bild" />
                <small>{{ dateiname }}</small>
                <div class="aufnahmezeit">{{ aufnahmezeit }}</div>
            </div>
        {% endfor %}
    </div>

    <script>
        function updateTime() {
            const uhrzeitElem = document.getElementById('uhrzeit');
            const now = new Date();
            const timeString = now.toLocaleTimeString('de-DE');
            uhrzeitElem.textContent = timeString;
        }
        setInterval(updateTime, 1000);

        // JS-Button-Handling fÃ¼r Galerie lÃ¶schen
        document.getElementById('delete-btn').addEventListener('click', async () => {
            if (!confirm("Willst du wirklich alle Bilder lÃ¶schen?")) return;

            try {
                const response = await fetch('/gallery/clear', {
                    method: 'DELETE'
                });
                const result = await response.json();
                alert(result.message || result.error || "Unbekannter Fehler");

                if (response.ok) {
                    location.reload(); // Seite neu laden, um leere Galerie zu zeigen
                }
            } catch (err) {
                alert("Netzwerkfehler oder Server nicht erreichbar.");
            }
        });
    </script>
</body>
</html>

